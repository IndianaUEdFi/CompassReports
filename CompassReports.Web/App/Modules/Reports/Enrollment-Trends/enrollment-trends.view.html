<md-toolbar class="md-hue-1">
    <div class="md-toolbar-tools" style="max-height: none;" ng-style="{'height': ctrl.filters.filtering() ? 'inherit' : ''}">
        <h3 style="padding-right: 50px; white-space: nowrap">Enrollment Trends</h3>
        
        <ul class="filter-status">
            <li ng-if="ctrl.filters.SchoolYears.length">
                School Year<br />
                <div style="font-size: 12px">
                    <span ng-repeat="schoolYear in ctrl.filters.SchoolYears">{{ctrl.displaySchoolYears[schoolYear]}}<span ng-if="!$last">, </span></span>
                </div>
            </li>
            <li ng-if="ctrl.filters.Grades.length">
                Grade Levels<br/>
                <div style="font-size: 12px">
                    <span ng-repeat="grade in ctrl.filters.Grades">{{grade}}<span ng-if="!$last">, </span></span>
                </div>
            </li>
            <li ng-if="ctrl.filters.Ethnicities.length">
                Ethnicities<br/>
                <div style="font-size: 12px">
                    <span ng-repeat="ethnicitiy in ctrl.filters.Ethnicities">{{ethnicitiy}}<span ng-if="!$last">, </span></span>
                </div>
            </li>
            <li ng-if="ctrl.filters.LunchStatuses.length">
            Meal Plans<br/>
            <div style="font-size: 12px">
                <span ng-repeat="status in ctrl.filters.LunchStatuses">{{status}}<span ng-if="!$last">, </span></span>
            </div>
            <li ng-if="ctrl.filters.SpecialEducationStatuses.length">
                Education Types<br/>
                <div style="font-size: 12px">
                    <span ng-repeat="status in ctrl.filters.SpecialEducationStatuses">{{status}}<span ng-if="!$last">, </span></span>
                </div>
            </li>
            <li ng-if="ctrl.filters.EnglishLanguageLearnerStatuses.length">
                Language Learners<br/>
                <div style="font-size: 12px">
                    <span ng-repeat="status in ctrl.filters.EnglishLanguageLearnerStatuses">{{status}}<span ng-if="!$last">, </span></span>
                </div>
            </li>
        </ul>
        <span flex></span>
        <div style="padding-left: 30px">
            <md-button class="md-raised md-accent md-hue-2" ng-click="ctrl.toggleFilters()">
                Filters
            </md-button>
        </div>
    </div>
</md-toolbar>

<md-sidenav class="md-sidenav-right md-whiteframe-4dp" md-component-id="filternav" id="filternav">
    <md-toolbar class="md-toolbar-tools md-accent md-hue-2">
        <h2 >Filters</h2>
        <span flex></span>
        <md-button class="md-fab md-mini md-primary md-hue-1" ng-click="ctrl.toggleFilters()">
            <md-icon md-font-set="material-icons">keyboard_arrow_right</md-icon>
        </md-button>
    </md-toolbar>
    <md-content layout-padding>
        <div layout="row" layout-align="center">
            <md-button flex="40" class="md-raised md-primary md-hue-1" ng-click="ctrl.apply()">Apply</md-button>
            <md-button flex="40" class="md-raised md-primary md-hue-1" ng-click="ctrl.reset()">Reset</md-button>
        </div>
        <form name="ctrl.filterForm">
            <div layout="column" layout-wrap>
                <md-input-container flex="100">
                    <label>School Year</label>
                    <md-select ng-model="ctrl.filters.SchoolYears" multiple>
                        <md-option ng-repeat="year in ctrl.schoolYears" ng-value="year.Value">{{year.Display}}</md-option>
                    </md-select>
                </md-input-container>
                <md-input-container flex="100">
                    <label>Grade Levels</label>
                    <md-select ng-model="ctrl.filters.Grades" multiple>
                        <md-option ng-repeat="grade in ctrl.grades" ng-value="grade">{{grade}}</md-option>
                    </md-select>
                </md-input-container>
                <md-input-container flex="100">
                    <label>Ethnicities</label>
                    <md-select ng-model="ctrl.filters.Ethnicities" multiple>
                        <md-option ng-repeat="ethnicity in ctrl.ethnicities" ng-value="ethnicity">{{ethnicity}}</md-option>
                    </md-select>
                </md-input-container>
                <md-input-container flex="100">
                    <label>Meal Plans</label>
                    <md-select ng-model="ctrl.filters.LunchStatuses" multiple>
                        <md-option ng-repeat="status in ctrl.lunchStatuses" ng-value="status">{{status}}</md-option>
                    </md-select>
                </md-input-container>
                <md-input-container flex="100">
                    <label>Education Types</label>
                    <md-select ng-model="ctrl.filters.SpecialEducationStatuses" multiple>
                        <md-option ng-repeat="status in ctrl.specialEducationStatuses" ng-value="status">{{status}}</md-option>
                    </md-select>
                </md-input-container>
                <md-input-container flex="100">
                    <label>English Language Learners</label>
                    <md-select ng-model="ctrl.filters.EnglishLanguageLearnerStatuses" multiple>
                        <md-option ng-repeat="status in ctrl.englishLanguageLearnerStatuses" ng-value="status">{{status}}</md-option>
                    </md-select>
                </md-input-container>
            </div>
        </form>
    </md-content>
</md-sidenav>

<md-content flex style="overflow-x: hidden">

    <div layout="row" layout-wrap flex>
        <div flex-xl="100" flex-lg="50" flex-md="100" flex-sm="100" ng-repeat="chart in ctrl.charts">
            <md-card>
                <md-toolbar class="md-accent md-hue-1" style="height: 50px">
                    <div class="md-toolbar-tools">
                        <h3>{{chart.Chart.Title}}</h3>
                        <span flex></span>
                        <div>
                            <md-button class="md-fab md-mini md-primary md-hue-1" ng-click="chart.ShowChart = !chart.ShowChart">
                                <md-icon ng-if="chart.ShowChart" md-font-set="material-icons">grid_on</md-icon>
                                <md-icon ng-if="!chart.ShowChart" md-font-set="material-icons">equalizer</md-icon>
                            </md-button>
                        </div>
                    </div>
                </md-toolbar>
                <md-card-content>
                    <div ng-if="!chart.ShowChart">
                        <table class="material-table material-table-bordered">
                            <thead>
                            <tr>
                                <th ng-repeat="header in chart.Chart.Headers">{{header}}</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="label in chart.Chart.Series" class="data-rows">
                                <td style="width: 20px"><md-icon ng-style="{'color': chart.Colors[$index]}" md-font-set="material-icons">stop</md-icon></td>
                                <td>{{label}}</td>
                                <td ng-repeat="value in chart.Chart.Data[$index] track by $index">
                                    {{value}}
                                </td>
                            </tr>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <th></th>
                                    <th>Enrollment Total</th>
                                    <th ng-repeat="total in chart.Chart.Totals track by $index">{{total}}</th>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                    <div ng-if="chart.ShowChart" style="position: relative; height: 50vh">
                        <canvas id="pie{{$index}}" class="chart chart-bar" chart-data="chart.Chart.Data" chart-series="chart.Chart.Series" chart-labels="chart.Chart.Labels" chart-options="chart.Options" chart-colors="chart.Colors"></canvas>                        
                    </div>
                </md-card-content>
            </md-card>
        </div>

    </div>
</md-content>